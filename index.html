<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ìƒíƒœí™˜ê²½ í€´ì¦ˆ</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#4ee1a0;
    --accent-2:#6fb8ff;
    --glass: rgba(255,255,255,0.04);
    --muted: #9aa6b2;
    --radius:14px;
    font-family: "Inter", "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#071021 0%, var(--bg) 100%);color:#e6f0f2}
  .wrap{max-width:940px;margin:28px auto;padding:20px}
  header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
  header .logo{
    width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
    display:flex;align-items:center;justify-content:center;font-weight:700;color:#052226;font-size:20px;box-shadow:0 6px 28px rgba(50,160,140,0.14);
  }
  header h1{margin:0;font-size:20px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));backdrop-filter: blur(6px); border-radius:var(--radius); padding:18px;box-shadow: 0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}
  .meta{display:flex;gap:12px;align-items:center;color:var(--muted);font-size:13px;margin-bottom:12px}
  .progressWrap{flex:1;background:rgba(255,255,255,0.03);height:10px;border-radius:999px;overflow:hidden}
  .progressBar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}
  .scoreChip{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:12px;color:var(--muted);font-weight:600}

  .quizArea{display:grid;grid-template-columns:1fr 320px;gap:18px;margin-top:8px}
  @media (max-width:880px){ .quizArea{grid-template-columns:1fr} .aside{order:2} }

  .questionBox{padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}
  .qnum{font-size:13px;color:var(--muted);margin-bottom:6px}
  .qtext{font-size:18px;margin:0 0 16px 0;line-height:1.4}
  .options{display:grid;gap:10px}
  .opt{
    background:var(--glass);border:1px solid rgba(255,255,255,0.03);
    padding:12px;border-radius:10px;cursor:pointer;display:flex;gap:10px;align-items:center;transition:all .18s;
  }
  .opt:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.45)}
  .opt .label{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-weight:700;background:rgba(255,255,255,0.02);color:var(--muted)}
  .opt .text{flex:1;color:#e9fbf3}
  .opt.correct{border-color: rgba(78,225,160,0.8);box-shadow:0 6px 20px rgba(78,225,160,0.06);background:linear-gradient(90deg, rgba(78,225,160,0.06), rgba(111,184,255,0.02))}
  .opt.wrong{border-color: rgba(255,92,92,0.9);box-shadow:0 6px 20px rgba(255,92,92,0.06);background:linear-gradient(90deg, rgba(255,92,92,0.04), rgba(255,255,255,0.01))}
  .opt.disabled{opacity:0.7;cursor:default;transform:none}

  .aside{padding:16px;border-radius:12px;height:100%;display:flex;flex-direction:column;gap:12px}
  .timer{font-size:13px;color:var(--muted)}
  .btnRow{display:flex;gap:8px;flex-wrap:wrap}
  button.btn{
    border:0;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#052226;
  }
  button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
  .explain{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;color:var(--muted);font-size:14px}

  .result{
    text-align:center;padding:28px;border-radius:12px;margin-top:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)));
  }
  .bigScore{font-size:44px;font-weight:800;color:var(--accent-2);margin:6px 0}
  .smallTxt{color:var(--muted);font-size:14px}

  footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">EQ</div>
      <div>
        <h1 style="margin:0">ìƒíƒœí™˜ê²½ í€´ì¦ˆ</h1>
        <div style="color:var(--muted);font-size:13px;margin-top:4px">ëª¨ë“  ì—°ë ¹ì„ ìœ„í•œ ê¸°ì´ˆ ìƒíƒœí™˜ê²½ ìƒì‹ â€” 10ë¬¸ì œ</div>
      </div>
    </header>

    <div class="card">
      <div class="meta">
        <div class="scoreChip" id="scoreChip">ì ìˆ˜: 0 / 10</div>
        <div class="progressWrap" aria-hidden="true">
          <div class="progressBar" id="progressBar" style="width:0%"></div>
        </div>
        <div class="meta" style="margin-left:auto">
          <div class="timer" id="qTimer">ë¬¸ì œ ì‹œê°„: 00:30</div>
        </div>
      </div>

      <div class="quizArea">
        <div class="questionBox" id="questionBox">
          <!-- ì§ˆë¬¸ ì˜ì—­ -->
          <div class="qnum" id="qNum">ë¬¸ì œ 1 / 10</div>
          <h2 class="qtext" id="qText">ë¡œë”© ì¤‘...</h2>

          <div class="options" id="options"></div>

          <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
            <div id="feedback" class="smallTxt" style="min-height:20px"></div>
            <div style="display:flex;gap:8px">
              <button class="ghost" id="skipBtn">ë‹¤ìŒ ë¬¸ì œ â–¶</button>
            </div>
          </div>
        </div>

        <aside class="aside card" style="min-height:160px">
          <div class="smallTxt">í˜„ì¬ ë¬¸ì œ</div>
          <div style="font-weight:800;font-size:20px" id="asideQ">1</div>

          <div class="smallTxt" style="margin-top:6px">ë‚¨ì€ ì‹œê°„ (ë¬¸ì œë³„)</div>
          <div style="font-size:18px;font-weight:700" id="asideTimer">00:30</div>

          <div style="margin-top:12px" class="btnRow">
            <button id="startBtn" class="btn">ì‹œì‘í•˜ê¸°</button>
            <button id="restartBtn" class="ghost">ë‹¤ì‹œí•˜ê¸°</button>
            <button id="showAnswersBtn" class="ghost">ì •ë‹µ ë³´ê¸°</button>
          </div>

          <div style="margin-top:12px" class="explain" id="explainBox">ì„ íƒ í›„ 'ë‹¤ìŒ ë¬¸ì œ'ë¥¼ ëˆ„ë¥´ê±°ë‚˜ ìë™ìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</div>
        </aside>
      </div>

      <div id="resultArea" style="display:none;margin-top:16px" class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="smallTxt">ìµœì¢… ì ìˆ˜</div>
            <div class="bigScore" id="finalScore">0 / 10</div>
            <div class="smallTxt" id="finalMsg">ê²°ê³¼ ë©”ì‹œì§€</div>
          </div>
          <div style="text-align:right">
            <button id="retryBtn" class="btn">ë‹¤ì‹œ í’€ê¸°</button>
            <button id="exportBtn" class="ghost">ê²°ê³¼ ë‚´ë³´ë‚´ê¸°</button>
          </div>
        </div>

        <div style="margin-top:12px" id="reviewList"></div>
      </div>

    </div>

    <footer>Made with â™»ï¸ â€” ìƒíƒœí™˜ê²½ ìƒì‹ í–¥ìƒ í”„ë¡œì íŠ¸</footer>
  </div>

<script>
/* =====================================================
   ë¬¸ì œ ë°ì´í„° (10ê°œ) â€” ê° ë¬¸ì œ: q, choices[4], answer (index), explanation
   ëª¨ë“  í•œê¸€ë¡œ ì œê³µ
   ===================================================== */
const QUIZ_DATA = [
  {
    q: "ìƒíƒœê³„ì—ì„œ ìƒì‚°ì(Producer)ì˜ ì—­í• ì€ ë¬´ì—‡ì¸ê°€?",
    choices: [
      "ë‹¤ë¥¸ ë™ë¬¼ì„ ë¨¹ì–´ ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤",
      "ë¬´ê¸°ë¬¼(íƒœì–‘ê´‘)ë¡œë¶€í„° ìœ ê¸°ë¬¼ì„ ë§Œë“¤ê³  ì—ë„ˆì§€ë¥¼ ì €ì¥í•œë‹¤",
      "ë¶„í•´ìë¡œì„œ ìœ ê¸°ë¬¼ì„ ë¶„í•´í•˜ì—¬ ì˜ì–‘ë¶„ì„ ëŒë ¤ì¤€ë‹¤",
      "ì„œì‹ì§€ë¥¼ ì œê³µí•˜ëŠ” ë¹„ìƒë¬¼ì  ìš”ì†Œë¥¼ ëœ»í•œë‹¤"
    ],
    answer: 1,
    explanation: "ìƒì‚°ìëŠ” ì£¼ë¡œ ì‹ë¬¼ê³¼ ì¡°ë¥˜ì²˜ëŸ¼ ê´‘í•©ì„±ì„ í†µí•´ ë¬´ê¸°ë¬¼ê³¼ ë¹›ì„ ì´ìš©í•´ ìœ ê¸°ë¬¼ì„ ë§Œë“¤ë©°, ìƒíƒœê³„ì˜ ì—ë„ˆì§€ ê³µê¸‰ì› ì—­í• ì„ í•©ë‹ˆë‹¤."
  },
  {
    q: "ê¸°í›„ë³€í™”ì˜ ì£¼ìš” ì›ì¸ìœ¼ë¡œ ê°€ì¥ ë„ë¦¬ ì¸ì •ë˜ëŠ” ê²ƒì€?",
    choices: [
      "ì˜¤ì¡´ì¸µ íŒŒê´´ë¡œ ì¸í•œ ìì™¸ì„  ì¦ê°€",
      "ì§€êµ¬ ê³µì „ ê¶¤ë„ì˜ ë³€í™”",
      "ì˜¨ì‹¤ê°€ìŠ¤(ì˜ˆ: ì´ì‚°í™”íƒ„ì†Œ)ì˜ ì¦ê°€",
      "íƒœì–‘ í™œë™ì˜ ê¸‰ê²©í•œ ì¦ê°€"
    ],
    answer: 2,
    explanation: "ì˜¨ì‹¤ê°€ìŠ¤ì˜ ê¸‰ê²©í•œ ì¦ê°€ëŠ” ì§€êµ¬ì˜ ë³µì‚¬ìˆ˜ì§€ì— ì˜í–¥ì„ ì£¼ì–´ í‰ê·  ê¸°ì˜¨ì„ ìƒìŠ¹ì‹œí‚¤ëŠ” ì£¼ìš” ì›ì¸ìœ¼ë¡œ ì¸ì •ë©ë‹ˆë‹¤."
  },
  {
    q: "ì™¸ë˜ì¢…ì´ ìƒíƒœê³„ì— ë¯¸ì¹˜ëŠ” ë¶€ì •ì  ì˜í–¥ì€ ë¬´ì—‡ì¸ê°€?",
    choices: [
      "í† ì–‘ì˜ í™”í•™ì  ì„±ë¶„ì„ í•­ìƒ ê°œì„ í•œë‹¤",
      "í† ì°©ì¢…ê³¼ ê²½ìŸí•˜ê±°ë‚˜ í¬ì‹í•˜ì—¬ ìƒë¬¼ë‹¤ì–‘ì„±ì„ ê°ì†Œì‹œí‚¨ë‹¤",
      "ê¸°í›„ë¥¼ ì•ˆì •í™”ì‹œí‚¤ëŠ” ì—­í• ì„ í•œë‹¤",
      "ì™¸ë˜ì¢…ì€ í•­ìƒ ë¬´í•´í•˜ê³  ì˜¤íˆë ¤ ìœ ìµí•˜ë‹¤"
    ],
    answer: 1,
    explanation: "ì¼ë¶€ ì™¸ë˜ì¢…ì€ í† ì°©ì¢…ê³¼ ìì›ê³¼ ê³µê°„ì„ ë†“ê³  ê²½ìŸí•˜ê±°ë‚˜ ì§ì ‘ í¬ì‹í•˜ì—¬ ì§€ì—­ ìƒë¬¼ë‹¤ì–‘ì„±ì„ ì¤„ì´ê³¤ í•©ë‹ˆë‹¤."
  },
  {
    q: "ìƒíƒœê³„ ì„œë¹„ìŠ¤(Ecosystem services)ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ê²ƒì€?",
    choices: [
      "ìˆ˜ì§ˆ ì •í™”ì™€ íƒ„ì†Œ ì €ì¥",
      "ë†ì‘ë¬¼ì˜ ìˆ˜ë¶„ ë§¤ê°œ(ìˆ˜ë¶„ì ì œê³µ)",
      "ë°”ì´ëŸ¬ìŠ¤ ì „íŒŒì˜ ì´‰ì§„",
      "ê²½ê´€ì„ í†µí•œ íœ´ì–‘Â·ê´€ê´‘ ê°€ì¹˜"
    ],
    answer: 2,
    explanation: "ìƒíƒœê³„ ì„œë¹„ìŠ¤ëŠ” ì¸ê°„ì—ê²Œ ì´ìµì´ ë˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ, 'ë°”ì´ëŸ¬ìŠ¤ ì „íŒŒì˜ ì´‰ì§„'ì€ ì„œë¹„ìŠ¤ê°€ ì•„ë‹ˆë¼ ë¶€ì •ì  ì˜í–¥ì…ë‹ˆë‹¤."
  },
  {
    q: "ë¹„ì ì˜¤ì—¼(Non-point source pollution)ì˜ ì˜ˆë¡œ ì•Œë§ì€ ê²ƒì€?",
    choices: [
      "ê³µì¥ êµ´ëšì—ì„œ ë‚˜ì˜¤ëŠ” ì—°ê¸°",
      "í•˜ì²œìœ¼ë¡œ íë¥´ëŠ” ë†ê²½ì§€ì˜ ë¹„ë£Œ ìœ ì¶œ",
      "í•˜ìˆ˜ ì²˜ë¦¬ì¥ ë°°ì¶œìˆ˜ì˜ íŠ¹ì • ë°°ì¶œêµ¬",
      "ì •ìœ ê³µì¥ì˜ ê¸°ë¦„ ëˆ„ì¶œ"
    ],
    answer: 1,
    explanation: "ë¹„ì ì˜¤ì—¼ì€ íŠ¹ì •í•œ ë°°ì¶œêµ¬ê°€ ì•„ë‹Œ ë„“ì€ ì§€ì—­ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ì—¼ìœ¼ë¡œ, ë†ì§€ì—ì„œ ì¥ë§ˆì² ì— ì”»ê²¨ ë‚´ë ¤ì˜¤ëŠ” ë¹„ë£Œë‚˜ ë†ì•½ ë“±ì´ ëŒ€í‘œì ì…ë‹ˆë‹¤."
  },
  {
    q: "ë©¸ì¢… ìœ„ê¸°ì¢… ë³´í˜¸ì˜ ì§ì ‘ì  ì´ìœ ë¡œ ì˜³ì§€ ì•Šì€ ê²ƒì€?",
    choices: [
      "ìƒë¬¼ë‹¤ì–‘ì„± ìœ ì§€",
      "ìƒíƒœê³„ ê¸°ëŠ¥ ë³´ì „",
      "ì¢… ë‹¨ìœ„ì˜ ë³´í˜¸ëŠ” í•­ìƒ ì¸ê°„ ê²½ì œì— ì¦‰ê°ì  ì´ë“ì„ ì¤€ë‹¤",
      "ë¯¸ë˜ ì„¸ëŒ€ë¥¼ ìœ„í•œ ìì—° ìœ ì‚° ë³´ì „"
    ],
    answer: 2,
    explanation: "ë©¸ì¢…ì¢… ë³´í˜¸ëŠ” ì¤‘ìš”í•˜ì§€ë§Œ, 'í•­ìƒ ì¸ê°„ ê²½ì œì— ì¦‰ê°ì  ì´ë“'ì„ ì¤€ë‹¤ëŠ” ì£¼ì¥ì€ ê³¼ì¥ëœ ì¼ë°˜í™”ì…ë‹ˆë‹¤."
  },
  {
    q: "ìŠµì§€(wetland)ê°€ í™˜ê²½ì— ì£¼ëŠ” ì¤‘ìš”í•œ ì—­í• ì€?",
    choices: [
      "íƒ„ì†Œë¥¼ ì €ì¥í•˜ê³  í™ìˆ˜ ì™„í™”Â·ì„œì‹ì§€ ì œê³µ",
      "í•­ìƒ ê°€ê³µ ê°€ëŠ¥í•œ ê´‘ë¬¼ìì›ì„ í’ë¶€í•˜ê²Œ ì œê³µ",
      "ë„ì‹œ êµí†µì˜ í•µì‹¬ ì—­í• ì„ í•œë‹¤",
      "í† ì–‘ì˜ ì‚°ì„±ì„ ê·¹ëŒ€í™”í•œë‹¤"
    ],
    answer: 0,
    explanation: "ìŠµì§€ëŠ” íƒ„ì†Œ ì €ì¥, ì˜¤ì—¼ë¬¼ì§ˆ ì—¬ê³¼, í™ìˆ˜ ì™„í™”, ìƒë¬¼ ì„œì‹ì§€ ì œê³µ ë“± ì¤‘ìš”í•œ ìƒíƒœê³„ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
  },
  {
    q: "ìƒë¬¼ë‹¤ì–‘ì„±(Biodiversity)ì´ ë†’ì€ ìƒíƒœê³„ì˜ ì¥ì ì€?",
    choices: [
      "í™˜ê²½ ë³€í™”ì— ëŒ€í•œ ì €í•­ë ¥ê³¼ ë³µì›ë ¥ì´ ë†’ë‹¤",
      "í•­ìƒ ìƒì‚°ì„±ì´ ë‚®ë‹¤",
      "ì§ˆë³‘ì— ë” ì·¨ì•½í•˜ë‹¤",
      "ì™¸ë˜ì¢…ì— ì‰½ê²Œ ë°€ë¦°ë‹¤"
    ],
    answer: 0,
    explanation: "ë‹¤ì–‘í•œ ì¢…ì´ ì¡´ì¬í•˜ë©´ ê¸°ëŠ¥ì´ ë¶„ì‚°ë˜ì–´ í™˜ê²½ ë³€í™”ë‚˜ ìŠ¤íŠ¸ë ˆìŠ¤ì— ëŒ€í•œ ì €í•­ë ¥ê³¼ íšŒë³µë ¥ì´ ì¦ê°€í•©ë‹ˆë‹¤."
  },
  {
    q: "ì§€ì†ê°€ëŠ¥í•œ ìì› ì´ìš©(Sustainable use)ì˜ í•µì‹¬ ê°œë…ì€?",
    choices: [
      "í˜„ì¬ ì„¸ëŒ€ë§Œì˜ ìµœëŒ€ ì´ìµì„ ìš°ì„ í•œë‹¤",
      "ìì›ì˜ ì˜êµ¬ì  ê³ ê°ˆì„ í”¼í•˜ê³  ì¥ê¸°ì  ì´ìš©ì„ ë³´ì¥í•œë‹¤",
      "ìì› ì‚¬ìš©ì„ ì™„ì „íˆ ê¸ˆì§€í•œë‹¤",
      "ìì›ì˜ ì´ìš©ì€ ê·œì œ ì—†ì´ ììœ ë°©ì„ì´ ìµœì„ ì´ë‹¤"
    ],
    answer: 1,
    explanation: "ì§€ì†ê°€ëŠ¥ì„±ì€ ìì›ì„ ë¯¸ë˜ ì„¸ëŒ€ë„ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ ê´€ë¦¬í•˜ê³  ê³¼ë‹¤í•œ ì†Œë¹„ë¥¼ í”¼í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤."
  },
  {
    q: "íƒ„ì†Œ ë°œìêµ­(Carbon footprint)ì„ ì¤„ì´ëŠ” í–‰ë™ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì§€ ì•Šì€ ê²ƒì€?",
    choices: [
      "ëŒ€ì¤‘êµí†µì´ë‚˜ ìì „ê±° ì´ìš© ëŠ˜ë¦¬ê¸°",
      "ì—ë„ˆì§€ íš¨ìœ¨ ë†’ì€ ì œí’ˆ ì‚¬ìš©",
      "ë¶ˆí•„ìš”í•œ ì¥ê±°ë¦¬ í•­ê³µì—¬í–‰ì„ ìì£¼ í•˜ëŠ” ê²ƒ",
      "ì‹ë¬¼ ê¸°ë°˜ ì‹ë‹¨ ë¹„ì¤‘ì„ ë†’ì´ê¸°"
    ],
    answer: 2,
    explanation: "ì¥ê±°ë¦¬ í•­ê³µì—¬í–‰ì„ ìì£¼ í•˜ëŠ” ê²ƒì€ íƒ„ì†Œ ë°°ì¶œì„ í¬ê²Œ ëŠ˜ë¦¬ë¯€ë¡œ íƒ„ì†Œë°œìêµ­ì„ ì¤„ì´ëŠ” í–‰ë™ìœ¼ë¡œëŠ” ë¶€ì ì ˆí•©ë‹ˆë‹¤."
  }
];

/* =====================================================
   ìƒíƒœ ë³€ìˆ˜
   ===================================================== */
let current = 0;
let score = 0;
let timer = null;
const TIME_PER_QUESTION = 30; // ì´ˆ
let timeLeft = TIME_PER_QUESTION;
let answered = false;

/* =====================================================
   DOM ìš”ì†Œ
   ===================================================== */
const qNumEl = document.getElementById('qNum');
const qTextEl = document.getElementById('qText');
const optionsEl = document.getElementById('options');
const scoreChip = document.getElementById('scoreChip');
const progressBar = document.getElementById('progressBar');
const qTimer = document.getElementById('qTimer');
const asideTimer = document.getElementById('asideTimer');
const asideQ = document.getElementById('asideQ');
const feedback = document.getElementById('feedback');
const explainBox = document.getElementById('explainBox');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');
const skipBtn = document.getElementById('skipBtn');
const showAnswersBtn = document.getElementById('showAnswersBtn');
const resultArea = document.getElementById('resultArea');
const finalScore = document.getElementById('finalScore');
const finalMsg = document.getElementById('finalMsg');
const reviewList = document.getElementById('reviewList');
const retryBtn = document.getElementById('retryBtn');
const exportBtn = document.getElementById('exportBtn');
const startStateBtn = startBtn;

/* =====================================================
   ìœ í‹¸ë¦¬í‹°
   ===================================================== */
function pad(n){ return String(n).padStart(2,'0'); }
function updateProgress(){ 
  const pct = Math.round((current/QUIZ_DATA.length)*100);
  progressBar.style.width = pct + '%';
  scoreChip.textContent = `ì ìˆ˜: ${score} / ${QUIZ_DATA.length}`;
}
function updateTimerDisplay(){
  qTimer.textContent = `ë¬¸ì œ ì‹œê°„: ${pad(timeLeft)}`;
  asideTimer.textContent = pad(timeLeft);
}
function clearOptions(){
  optionsEl.innerHTML = '';
  feedback.textContent = '';
}

/* =====================================================
   ë Œë”ë§ (ë¬¸ì œ í‘œì‹œ)
   ===================================================== */
function renderQuestion(){
  if(current >= QUIZ_DATA.length){
    finishQuiz();
    return;
  }
  const item = QUIZ_DATA[current];
  qNumEl.textContent = `ë¬¸ì œ ${current+1} / ${QUIZ_DATA.length}`;
  qTextEl.textContent = item.q;
  asideQ.textContent = `${current+1}ë²ˆ`;
  clearOptions();
  // render choices
  item.choices.forEach((c,i)=>{
    const div = document.createElement('div');
    div.className = 'opt';
    div.dataset.index = i;
    div.innerHTML = `
      <div class="label">${String.fromCharCode(65+i)}</div>
      <div class="text">${c}</div>
    `;
    div.addEventListener('click', ()=> selectOption(div, i));
    optionsEl.appendChild(div);
  });
  // reset state
  answered = false;
  timeLeft = TIME_PER_QUESTION;
  updateTimerDisplay();
  updateProgress();
  explainBox.textContent = "ì„ íƒì§€ë¥¼ í´ë¦­í•˜ë©´ ì •ë‹µ ì—¬ë¶€ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
  startTimer();
}

/* =====================================================
   íƒ€ì´ë¨¸
   ===================================================== */
function startTimer(){
  stopTimer();
  timer = setInterval(()=>{
    timeLeft--;
    updateTimerDisplay();
    if(timeLeft <= 0){
      stopTimer();
      markTimeout();
    }
  }, 1000);
}
function stopTimer(){
  if(timer) { clearInterval(timer); timer = null; }
}

/* =====================================================
   ì„ íƒ ì²˜ë¦¬
   ===================================================== */
function selectOption(div, idx){
  if(answered) return;
  answered = true;
  stopTimer();
  const item = QUIZ_DATA[current];
  const correctIdx = item.answer;
  // disable all
  Array.from(optionsEl.children).forEach(o => {
    o.classList.add('disabled');
    o.style.pointerEvents = 'none';
  });
  if(idx === correctIdx){
    div.classList.add('correct');
    score++;
    feedback.textContent = 'ì •ë‹µì´ì—ìš” ğŸ‰';
  } else {
    div.classList.add('wrong');
    // highlight correct
    const correctEl = Array.from(optionsEl.children).find(c => Number(c.dataset.index) === correctIdx);
    if(correctEl) correctEl.classList.add('correct');
    feedback.textContent = 'ì•„ì‰¬ì›Œìš” â€” ì •ë‹µì„ í™•ì¸í•´ë³´ì„¸ìš”.';
  }
  explainBox.textContent = item.explanation || '';
  updateProgress();
}

/* =====================================================
   íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
   ===================================================== */
function markTimeout(){
  if(answered) return;
  answered = true;
  // mark correct
  const item = QUIZ_DATA[current];
  const correctIdx = item.answer;
  Array.from(optionsEl.children).forEach(o => {
    o.classList.add('disabled');
    o.style.pointerEvents = 'none';
  });
  const correctEl = Array.from(optionsEl.children).find(c => Number(c.dataset.index) === correctIdx);
  if(correctEl) correctEl.classList.add('correct');
  feedback.textContent = 'ì‹œê°„ ì´ˆê³¼! ìë™ìœ¼ë¡œ ì •ë‹µì„ í‘œì‹œí•©ë‹ˆë‹¤.';
  explainBox.textContent = item.explanation || '';
  updateProgress();
}

/* =====================================================
   ë‹¤ìŒ ë¬¸ì œ / ìŠ¤í‚µ / ì •ë‹µë³´ê¸° / ì‹œì‘ / ì¬ì‹œì‘
   ===================================================== */
function nextQuestion(){
  stopTimer();
  current++;
  if(current < QUIZ_DATA.length){
    renderQuestion();
  } else {
    finishQuiz();
  }
}

skipBtn.addEventListener('click', ()=>{
  // allow skip even if not answered: count as wrong and move on
  if(!answered){
    markTimeout(); // show correct
    // wait a short moment then next
    setTimeout(()=> { nextQuestion(); }, 900);
  } else {
    nextQuestion();
  }
});

showAnswersBtn.addEventListener('click', ()=>{
  // show all corrects for current
  const item = QUIZ_DATA[current];
  Array.from(optionsEl.children).forEach(o => {
    o.classList.add('disabled');
    o.style.pointerEvents = 'none';
  });
  const correctIdx = item.answer;
  const correctEl = Array.from(optionsEl.children).find(c => Number(c.dataset.index) === correctIdx);
  if(correctEl) correctEl.classList.add('correct');
  feedback.textContent = 'ì •ë‹µì´ ê°•ì¡°ë˜ì—ˆìŠµë‹ˆë‹¤.';
  explainBox.textContent = item.explanation || '';
  answered = true;
  stopTimer();
});

startBtn.addEventListener('click', ()=> {
  // reset and start
  current = 0; score = 0;
  resultArea.style.display = 'none';
  renderQuestion();
  updateProgress();
  startBtn.disabled = true;
  startBtn.textContent = 'ì§„í–‰ ì¤‘...';
});

restartBtn.addEventListener('click', ()=> {
  if(confirm('í€´ì¦ˆë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í• ê¹Œìš”? í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ë‚´ìš©ì€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.')){
    current = 0; score = 0;
    resultArea.style.display = 'none';
    renderQuestion();
    updateProgress();
    startBtn.disabled = true;
    startBtn.textContent = 'ì§„í–‰ ì¤‘...';
  }
});

/* =====================================================
   ì™„ë£Œ ì²˜ë¦¬ ë° ë¦¬ë·°
   ===================================================== */
function finishQuiz(){
  stopTimer();
  qNumEl.textContent = `ì™„ë£Œ`;
  qTextEl.textContent = `ëª¨ë“  ë¬¸ì œë¥¼ í’€ì—ˆìŠµë‹ˆë‹¤. ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.`;
  optionsEl.innerHTML = '';
  feedback.textContent = '';
  explainBox.textContent = '';
  updateProgress();
  // show result area
  resultArea.style.display = 'block';
  finalScore.textContent = `${score} / ${QUIZ_DATA.length}`;
  let pct = Math.round((score/QUIZ_DATA.length)*100);
  let msg = '';
  if(pct === 100) msg = 'í›Œë¥­í•´ìš”! ìƒíƒœí™˜ê²½ ìƒì‹ì„ ì™„ë²½íˆ ì•Œê³  ìˆêµ°ìš” ğŸ…';
  else if(pct >= 80) msg = 'ì•„ì£¼ ì¢‹ì•„ìš”! ëŒ€ë¶€ë¶„ì˜ ì§€ì‹ì„ ê°–ì¶”ê³  ìˆì–´ìš” ğŸ‘';
  else if(pct >= 50) msg = 'ê´œì°®ì•„ìš”. ì¢€ ë” ê³µë¶€í•˜ë©´ ë” ì˜í•  ìˆ˜ ìˆì–´ìš” ğŸ“š';
  else msg = 'ê¸°ë³¸ ê°œë…ì„ ë³µìŠµí•´ë´ìš”. ì‘ì€ ì‹¤ì²œì´ í° ë³€í™”ë¥¼ ë§Œë“­ë‹ˆë‹¤ ğŸŒ±';
  finalMsg.textContent = msg;

  // ë¦¬ë·°: ê° ë¬¸ì œì™€ ì •ë‹µ í‘œì‹œ
  reviewList.innerHTML = '';
  QUIZ_DATA.forEach((it, i) => {
    const div = document.createElement('div');
    div.style.padding = '10px';
    div.style.borderTop = '1px solid rgba(255,255,255,0.03)';
    div.innerHTML = `<div style="font-weight:700">${i+1}. ${it.q}</div>
                     <div style="margin-top:6px;color:var(--muted)">${it.choices.map((c, idx)=> {
                       const mark = idx === it.answer ? 'âœ”' : '&nbsp;&nbsp;';
                       return `<div style="margin:2px 0">${mark} <strong>${String.fromCharCode(65+idx)}.</strong> ${c}</div>`;
                     }).join('')}</div>
                     <div style="margin-top:8px;color:var(--muted)"><em>í•´ì„¤:</em> ${it.explanation}</div>`;
    reviewList.appendChild(div);
  });

  // allow restart
  startBtn.disabled = false;
  startBtn.textContent = 'ì‹œì‘í•˜ê¸°';
}

/* =====================================================
   ê²°ê³¼ ë‚´ë³´ë‚´ê¸°(ê°„ë‹¨ JSON)
   ===================================================== */
exportBtn.addEventListener('click', ()=>{
  const payload = {
    date: new Date().toISOString(),
    score,
    total: QUIZ_DATA.length
  };
  const blob = new Blob([JSON.stringify(payload, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `ecology-quiz-result-${new Date().toISOString().slice(0,10)}.json`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

/* =====================================================
   í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ìƒíƒœ
   ===================================================== */
(function init(){
  // show first question in neutral state but timer not started until Start
  current = 0; score = 0;
  qNumEl.textContent = `ì¤€ë¹„`;
  qTextEl.textContent = `ì‹œì‘í•˜ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ í€´ì¦ˆë¥¼ ì‹œì‘í•˜ì„¸ìš”.`;
  optionsEl.innerHTML = '';
  updateProgress();
  updateTimerDisplay();
})();
</script>
</body>
</html>
